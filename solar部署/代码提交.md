1.在 gitlab上新建项目仓库, 通过命令行把上一个版本的代码发布



2.配置 pycharm 连接 gitlab, 避免反复 写 用户名和密码



3.修改 settings.py 文件, 把上一个版本的代码跑起来.

- 配置mysql数据库, 两个选择:  可视化工具  |  命令行

- 给mysql 分配用户名和权限, 不要用 root 用户名和权限.

  ```shell
  # 此坑待填, 此语法和mysql的版本关系很大, 要注意
  grant all privileges on 库.表 to 用户名 identified by "密码";  # 分配对了,才能正常显示
  # 库: 指定数据库;
  # 表: 如果没有具体的表, 可以用 * 来指代所有的表
  # 用户名: 不加 引号
  # 密码: 必须加引号
  ```



4.安装 `mysqlclient-1.3.12`的时候如果报错:

![报错信息](./安装mysqlclient报错.png)

 原因: 缺少python的依赖环境, 我试过网上的: `ln -s /usr/local/mysql/bin/mysql_config /usr/local/bin/mysql_config` 发现在 `ubuntu16.04` 下无效.

最终解决办法: `sudo apt-get install libmysqlclient-dev`,    可能有的还需要安装  `python3-dev`



**API**

```json
{
    "api/web/v2/codes": "http://127.0.0.1:8000/api/web/v2/codes/",
    "api/web/v2/register": "http://127.0.0.1:8000/api/web/v2/register/",
    "api/web/v2/login": "http://127.0.0.1:8000/api/web/v2/login/",
    "api/web/v2/logout": "http://127.0.0.1:8000/api/web/v2/logout/",
    "api/web/v2/update/company": "http://127.0.0.1:8000/api/web/v2/update/company/",
    "api/web/v2/industries": "http://127.0.0.1:8000/api/web/v2/industries/",
    "api/web/v2/update/user_info": "http://127.0.0.1:8000/api/web/v2/update/user_info/",
    "api/web/v2/drones/common": "http://127.0.0.1:8000/api/web/v2/drones/common/",
    "api/web/v2/payloads/common": "http://127.0.0.1:8000/api/web/v2/payloads/common/",
    "api/web/v2/company/drones": "http://127.0.0.1:8000/api/web/v2/company/drones/",
    "api/web/v2/company/payloads": "http://127.0.0.1:8000/api/web/v2/company/payloads/",
    "api/web/v2/applications": "http://127.0.0.1:8000/api/web/v2/applications/",
    "api/web/v2/company/projects": "http://127.0.0.1:8000/api/web/v2/company/projects/",
    "api/web/v2/company/task_templates": "http://127.0.0.1:8000/api/web/v2/company/task_templates/",
    "api/web/v2/company/apps": "http://127.0.0.1:8000/api/web/v2/company/apps/",
    "api/web/v2/company/app_temp_config": "http://127.0.0.1:8000/api/web/v2/company/app_temp_config/",
    "api/web/v2/company/tasks": "http://127.0.0.1:8000/api/web/v2/company/tasks/",
    "api/web/v2/upload_file": "http://127.0.0.1:8000/api/web/v2/upload_file/",
    "api/web/v2/app_config": "http://127.0.0.1:8000/api/web/v2/app_config/",
    "api/web/v2/get_users": "http://127.0.0.1:8000/api/web/v2/get_users/",
    "api/web/v2/get_project_tasks": "http://127.0.0.1:8000/api/web/v2/get_project_tasks/",
    "api/web/v2/smart_flight_resources": "http://127.0.0.1:8000/api/web/v2/smart_flight_resources/",
    "api/web/v2/get_fly_safe_info": "http://127.0.0.1:8000/api/web/v2/get_fly_safe_info/",
    "api/web/v2/common_flights": "http://127.0.0.1:8000/api/web/v2/common_flights/",
    "api/web/v2/update_task_app": "http://127.0.0.1:8000/api/web/v2/update_task_app/",
    "api/web/v2/mobile_device/common": "http://127.0.0.1:8000/api/web/v2/mobile_device/common/",
    "api/web/v2/company/mobile_device": "http://127.0.0.1:8000/api/web/v2/company/mobile_device/",
    "api/web/v2/company/get_task_applications_info": "http://127.0.0.1:8000/api/web/v2/company/get_task_applications_info/",
    "api/web/v2/company_register_code": "http://127.0.0.1:8000/api/web/v2/company_register_code/",
    "api/web/v2/flying_drones": "http://127.0.0.1:8000/api/web/v2/flying_drones/",
    "api/web/v2/task_app_status": "http://127.0.0.1:8000/api/web/v2/task_app_status/",
    "api/web/v2/update_task_app_status": "http://127.0.0.1:8000/api/web/v2/update_task_app_status/",
    "api/web/v2/drone_insurance": "http://127.0.0.1:8000/api/web/v2/drone_insurance/",
    "api/web/v2/company/pilot": "http://127.0.0.1:8000/api/web/v2/company/pilot/",
    "api/web/v2/company/pv_detection": "http://127.0.0.1:8000/api/web/v2/company/pv_detection/",
    "api/web/v2/company/defects": "http://127.0.0.1:8000/api/web/v2/company/defects/",
    "api/app/v2/task_flights": "http://127.0.0.1:8000/api/app/v2/task_flights/",
    "api/app/v2/login": "http://127.0.0.1:8000/api/app/v2/login/",
    "api/app/v2/app_flights": "http://127.0.0.1:8000/api/app/v2/app_flights/",
    "api/app/v2/company_drone_info": "http://127.0.0.1:8000/api/app/v2/company_drone_info/",
    "api/app/v2/smart_flight_resources": "http://127.0.0.1:8000/api/app/v2/smart_flight_resources/",
    "api/app/v2/company/projects": "http://127.0.0.1:8000/api/app/v2/company/projects/"
}
```



虚拟机网络问题:

- 1.要在操作系统的内部右下角, 设置网路的设置是:  `桥接模式`
- 2.要保证虚拟机的上面`虚拟网路设置` 必须是 桥接模式
- 3.推测(可能有错误, 仅个人电脑操作发现):  
  - 3.1如果虚拟网卡绑定的是无线网卡, 那么不能设置固定ip, 否则 "一宿两虚" 之间总有个别之间不能通信.
  - 3.2如果虚拟网卡绑定的是有限网卡, 那么似乎可以设置固定ip.
- 4.要关闭宿主机的外网防火墙,   否则可能出现 内网可以访问外网("虚拟机可以ping通宿主机"),  但是外网没法访问内网("宿主机没法ping通虚拟机")
- 5.通过 ping 来保证网络都是互相可以通信的. 然后, WIN10 配置 防火墙的高级设置 , 配置 ==出入站规则==
- 6.云服务器还要考虑到 `配置安全组`
- 7.如果是宿主机或者局域网访问 pycharm启动的 django应用, 那么启动脚本不能使用默认的 127.0.0.1的ip, 而应该更换成  0.0.0.0的 ip.



**网络问题(续)**

远程生产服务器部署, 考虑安全组问题, 需要查看端口开放问题:

- `telent ip port`



```latex
1./api/web/v1/login/  返回的数据:  全部应用列表 ->  部分应用列表.(不再返回应用列表)
修改版本号

2.新建电站类型.
增加模型类, 设置外键关联
```



**整理一个django开发的框架**





**整理一套完整的django部署的框架, 通过自动化脚本来实现**





项目可以复用,  目录必须要  使用 BASE_DIR

如果和别人合作, 有指定的目录, 也要再弄一个  TEMP_DIR



日志类进行一个封装, 其他类型的 日志配置  信息



**配置虚拟机内部的mysql给外部的navicat for mysql访问**

- 1.修改mysql的配置文件:   `/etc/mysql/mysql.conf.d/mysqld.cnf` , 注释掉 : `bind-address=127.0.0.1`
  - 1.1不同的mysql版本, 配置文件的位置可能有所不同;
  - 1.2 只读文件, 需要  `sudo` 权限
- 2.重启mysql服务  `service mysql restart`



版本管理



**自动生成api文档**

- 1.coreapi
- 2.



```python
cd /usr/local/src/kafka_2.11-1.1.0 && bin/zookeeper-server-start.sh -daemon config/zookeeper.properties
bin/kafka-server-start.sh config/server.properties
```



脚本问题

索要配置的域名



##### 安装搜狗输入法问题

- ##### 忘记去掉勾选 [√] **current** 

##### 

才安装的新OS， 需要很多依赖。所以报很多错， 还会出现 文件锁的问题

解决思路：

```shell
sudo rm /var/cache/apt/archives/lock
sudo rm /var/lib/dpkg/lock
```

解决 wsgi 安装报错的最终解决方案是:

报错信息:

```shell
    [thread 3][x86_64-linux-gnu-gcc -pthread] core/dot_h.o
    [thread 1][x86_64-linux-gnu-gcc -pthread] core/config_py.o
    *** uWSGI compiling embedded plugins ***
    [thread 0][x86_64-linux-gnu-gcc -pthread] plugins/python/python_plugin.o
    [thread 2][x86_64-linux-gnu-gcc -pthread] plugins/python/pyutils.o
    [thread 3][x86_64-linux-gnu-gcc -pthread] plugins/python/pyloader.o
    [thread 1][x86_64-linux-gnu-gcc -pthread] plugins/python/wsgi_handlers.o
    In file included from plugins/python/pyutils.c:1:0:
    plugins/python/uwsgi_python.h:2:20: fatal error: Python.h: No such file or directory
    compilation terminated.
    In file included from plugins/python/python_plugin.c:1:0:
    plugins/python/uwsgi_python.h:2:20: fatal error: Python.h: No such file or directory
    compilation terminated.
    In file included from plugins/python/pyloader.c:1:0:
    plugins/python/uwsgi_python.h:2:20: fatal error: Python.h: No such file or directory
    compilation terminated.
    In file included from plugins/python/wsgi_handlers.c:1:0:
    plugins/python/uwsgi_python.h:2:20: fatal error: Python.h: No such file or directory
    compilation terminated.
    
    ----------------------------------------
Command "/home/guang/.virtualenvs/AIsland/bin/python3 -u -c "import setuptools, tokenize;__file__='/tmp/pip-install-279e4kzn/uWSGI/setup.py';f=getattr(tokenize, 'open', open)(__file__);code=f.read().replace('\r\n', '\n');f.close();exec(compile(code, __file__, 'exec'))" install --record /tmp/pip-record-jjv5v2xd/install-record.txt --single-version-externally-managed --compile --install-headers /home/guang/.virtualenvs/AIsland/include/site/python3.5/uWSGI" failed with error code 1 in /tmp/pip-install-279e4kzn/uWSGI/
```

解决方案:

```shell
sudo apt-get install libpython3.x-dev
#  x 代表的是python的版本, 我这里是 3.5  所以就用的 3.5
```

 新的操作系统安装`pillow库`的时候要安装很多依赖环境:

- 针对  centos7 的操作系统

```
yum install zlib zlib-devel
yum install libjpeg libjpeg-devel
yum install freetype freetype-devel
```

- 针对 ubunut16.04操作系统

```shell
sudo apt-get install libtiff5-dev libjpeg8-dev zlib1g-dev libfreetype6-dev liblcms2-dev libwebp-dev tcl8.6-dev tk8.6-dev python-tk
```



分纯python代码实现的库和 其他语言实现的python库

```shell
yum install python-devel
yum install zlib-devel
yum install libjpeg-turbo-devel
```

脚本的原因:

**监听程序应该怎么写才更加有通用性呢?**





分支切换问题

```shell
git clone 
git pull origin dev
git branch  # 查看当前本地分支
git branch --set-upstream-to=origin/dev  # 本地分支关联到远程的dev分支
git push origin 本地分支名  # 提交本地分支到远程仓库
```

好好学习一下git 吧, 太菜了





mysqlclient

>  OSError: mysql_config not found
>
> 缺少依赖, 需要安装 `sudo apt-get install python3.5-dev libmysqlclient-dev`      这里 3.5 是我的python解释器版本号
>
> ​	注:  操作系统的版本是:   ubuntu16.04





服务单独一个个是否能启动, 然后联合测试

> 居然遇到一个 mysql 版本问题
>
> 关于MySQL服务的数据卷映射:
>
> - 1.冒号前面是宿主机的目录, 后面是容器内部的目录
> - 2.容器内部的目录不是宿主机的目录, 这里有点绕. 但是我之前理解的就是错误的.



ubuntu 安装  pdfkit 的依赖

```latex
apt-get -f install fonts-dejavu-core libfontconfig1 fontconfig-config  libfontenc1 fontconfig libxrender1 x11-common  libxfont1 xfonts-encodings xfonts-utils xfonts-base xfonts-75dpi
```



---

## 2019.4.22 -- 2019.4.28

1.创建超级用户:

```
username :  13207163828
email: guang@boonray.com
password: solar2019

pbkdf2_sha256$36000$VkrzSgoZYjyt$j4kqhONnaBp909wJV/AaKNfIDLR1JpH8KiLJsbHesLc=
pbkdf2_sha256$36000$RSQbDZ17TLMY$hq/St1Npjy4YU+qK+qmdjffv99qvt0XT6Oi7tHcPKjI=
pbkdf2_sha256$36000$iBcRsW0KB3Ps$eMesqRaSl7h93dSpu7egNj3gZD2oPyjmA8nTLMTIbmk=
行业版:
pbkdf2_sha256$36000$XxZnzxCDhYZX$P4tMQAvnJaTkar3SO0Uc0b61P3XvZfuciYiP64g2l6A=


"token": "f7c209a715ffaa8815b39efb620c1cbdb4e871dd"
```



登录成功的返回信息:

```
{
    "message": "登录成功",
    "data": {
        "privilege": "0",
        "company_id": null,
        "user_id": 1,
        "applications": [],
        "token": "f7c209a715ffaa8815b39efb620c1cbdb4e871dd",
        "last_login": "2019-04-22 11:31:36"
    },
    "code": 200
}
```



```
https://solar_api.boonray.com/api/web/v1/get_users/   # 公司下的所有成员

https://solar_api.boonray.com/api/web/v1/industries/  # 选行业相关, 去掉

每个电站 == 一个项目
prject/19/   admin 是项目所有者,   member 是项目成员

新建巡检  选择应用:光伏缺陷识别  去掉 ;  加上镜头数据

缺陷相关的接口:
https://solar_api.boonray.com/api/web/v1/company/pv_detection/?task_id=79

api/web/v2/company/tasks/ 新建任务(application_id 的问题)
```



应用算法端

```latex

```





#### Pycharm 导包错误

**报错信息:** `RuntimeError:  Model class models.User doesn't declare an explicit app_label and isn't in an application in INSTALLED_APPS`

**执行数据库迁移, 就会出现报错信息2:** `ModuleNotFoundError: No module named 'BookInfo'`

 **解决思路:**

```
将from models import BookInfo  改成 from .models import BookInfo
```

**问题原因(个人分析):**

pycharm和python导包的原因, 该项目是通过pycharm运行的所以它有 pycharm自己'智能'的导包路径.

实际上 通过python解释器自己的导包是没有问题的.





#### APIView 在视图函数运行时, 会进行异常捕获并生成合适的响应

```
存在疑问:
如
instance = BookInfo.objects.all().filter(is_delete=0, pk=pk).get()
instance.delete()
当 instance不存在的时候, 会导致服务器报  500 的错误.        
```



#### python 与属性相关的4个内置函数

##### 1. hasattr()   --  判断对象obj是否有属性attr_name

格式: `hasattr(obj, attr_name)`

- 传入参数:
  - obj -- 对象
  - attr_name -- 字符串, 属性名

- 返回: 
  - True
  - False

##### 2. getattr()  --  获取对象obj的属性attr_name 值, 支持默认值

格式: `getattr(obj, attr_name, [default])`

- 传入参数:
  - object  --  对象
  - attr_name  --  字符串, 对象属性名
  - default  -- 默认返回值, 如果不提供, 在没有对应属性的时候将 **触发 `AttributeError 异常`**
- 返回值:
  - 对象属性值

##### 3. setattr()  –  用于给对象设置(添加或修改)属性值 , (该属性可以不存在)

格式: `setattr(obj, attr_name, value)`

- 传入参数
  - obj  --  对象
  - attr_name  --  字符串, 对象属性名
  - value  --  给attr_name属性所赋的值
- 返回值:
  - None

##### 4.  delattr()  -- 用于删除属性

格式: `delattr(obj, attr_name)`      等价于   `del obj.attr_name`

- 传入参数:
  - object  --  对象
  - attr_name  --  字符串, 对象属性名
- 返回值:
  - None
- 注意:
  - 如果删除的属性不存在, 触发 **AttributeError异常**





---

#### 2019-05-07

1.今天上午解决BUG, 遇到的问题:

- 1.服务器调试代码不方便, 但是自己对与同事提出的解决思路只是浅尝辄止, 并没有进行深入;
- 2.最后发现可以通过自己规范的编码习惯去解决. 比如 python中普通变量的命名就是  全小写  或者  全大写. 不要搞什么首字母大写.

2.翻墙软件, 又是浅尝辄止

下午就有时间虚度的感觉, 归根到底还是自己的心不够宁静.



#### 2019-05-08

1.查询集的时候不再使用 外键

```
1.viewset中  路由前缀后面不要加 /  , 否则自己生成的路由是有问题的.
2.模型类是可以关联非主键的字段, 不需要在序列化器中再写一遍.
3.模型类与外键关联的名字, 是可以通过选项  db_column 去进行指定; 但是外键关联的模型如果不指定该字段, 那么格式总是: `属性名_id`
4.可以在继承的 genericAPIView 的视图类(包括是图集)中 修改默认的 lookup_field = 'pk' 的; 如果还是没法满足需求, 可以重写 get_object()方法.
```



python脚本  sys模块.



```latex
1.一个人的时间是有限的
2.任何能力的培养或者经历都需要耗费时间
3.看得见反馈的坚持,难, 但并不是最难的;工作中有难得多的枯燥的坚持和看不到未来的坚持,才是最难的;那才是考验.
4.专业的圈子实际很小, 要让自己的名字在这个圈子流传, 让别人觉得你是这个圈子的.
5.创业者就是披荆斩棘的往前走,过多的顾虑有害, 没有什么最佳时机.
6.喜欢的事情做到极致就是事业, 是否从爱好出发都很难, 没有说喜欢就会很容易, 只是喜欢你可能会更加能够坚持.
7.超级个体(个体IP)的时代, 个体比公司长寿.
8.任何行业,哪怕是风口, 都有壁垒.
9.多在具体事务的小细节上磨砺, 做一个有心人.
10.在商言商, 忘掉创业, 好好做生意, 先活下来.
11.沟通: 内容不是关键, 态度、情绪、思维才是关键
12."100个人只需要一个人开门就行."  ==> 明确的方向, 有作品, 在此基础上进行 '主动联系'
13.明确三种人:
- 导师: 真心愿意帮助、希望你成功的人;
- 队友: 同甘共苦的人 (策略, 产品, 营销, 资本)
- 金融伙伴: 买家\卖家\投资人
14.持续坚持可以把"反复重新开始"的恶习.
15.做出社会认可的标准:
- 沟通能力: 沟通成功过什么项目?
- 内容运营: 10w+ 的文章?
- 策划: 全民活动?
-----------------------------
晓英总谈论职业生涯的三重阶段:
第一重:
1.正确的价值观(喜欢什么?崇尚什么?)
2.处事态度(遇到困难和挫折之后的抉择?)
3.分析|解决问题的思路和技能
4.学习所在行业的理论体系和最佳实践
5.了解企业应用实践与行业、业务本身的挑战
6.确定至少一个专业领域, 并进行深耕
7.项目管理基本技能|掌握一套PDCA循环的做事方法
8.建立良好的沟通能力
9.招式自己能够坚持的身体锻炼方式
第二重:
1.更高形态的智慧: 同情与怜悯之心
2.初心与坚持(谦卑之心和洞察力)
3.认识事物的本源和基本规律
4.认识自己和了解自己
5.打造自己的专业名片
第三重:
1.回归简单
------------------------
16.今天的现状不是由今天决定, 而是由过去目标达成的结果.
17.不用花很多钱就可以大幅提升自己的事:衣着, 形体, 沟通.
```

