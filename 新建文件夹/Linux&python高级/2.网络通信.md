# 网路通信

## 一、`IP` 地址

### 1. 概述

网络编程:  进程间通信, 进行数据传输

### 2. `ip`地址

#### `ip`地址：用来在网络中标记一台电脑，比如192.168.1.1；在本地局域网上是唯一的。

### 3. ip地址的分类（了解）

每一个IP地址包括两部分：**网络地址和主机地址**

![ip地址](imgs/ip地址.jpg)

>- `IPV4`: `ip version4` 
>- 容纳最多主机数: `256*256*256*256`   , 4个字节共32个比特位.
>- 对于C类地址来说, 实际可用的主机号只有: `2*8-2=254台`
>  - `00000000 ~ 11111111` 既从 `0--255`, 但是两头的两个主机号不能用
>  - 所以, 只有 254 台.
>
>

#### 3.1 A类IP地址

一个A类IP地址由`1字节的网络地址`和`3字节主机地址`组成，网络地址的`最高位必须是“0”`，

地址范围: `1.0.0.1-126.255.255.254`

二进制表示为：00000001 00000000 00000000 00000001 - 01111110 11111111 11111111 11111110

可用的A类网络有126个，每个网络能容纳1677214个主机

#### 3.2 B类IP地址

一个B类IP地址由`2个字节的网络地址`和`2个字节的主机地址`组成，网络地址的`最高位必须是“10”`，

地址范围: `128.1.0.1-191.255.255.254`

二进制表示为：10000000 00000001 00000000 00000001 - 10111111 11111111 11111111 11111110

可用的B类网络有16384个，每个网络能容纳65534主机

#### 3.3 C类IP地址

一个C类IP地址由`3字节的网络地址`和`1字节的主机地址`组成，网络地址的`最高位必须是“110”`

范围192.0.1.1-223.255.255.254

二进制表示为: 11000000 00000000 00000001 00000001 - 11011111 11111111 11111110 11111110

C类网络可达2097152个，每个网络能容纳254个主机

#### 3.4 D类地址用于多点广播

D类IP地址第一个字节以“1110”开始，它是一个专门保留的地址。

它并不指向特定的网络，目前这一类地址被用在多点广播（Multicast）中

多点广播地址用来一次寻址一组计算机 s 地址范围224.0.0.1-239.255.255.254

> - 单播: **一对一**
> - 多播: **一对多**
> - 广播: **一对所有**

#### 3.5 E类IP地址

以“1111”开始，为将来使用保留

E类地址保留，仅作实验和开发用

#### 3.6 私有ip

在这么多网络IP中，国际规定有一部分IP地址是用于我们的局域网使用，也就

是属于私网IP，不在公网中使用的，它们的范围是：

```
10.0.0.0～10.255.255.255

172.16.0.0～172.31.255.255

192.168.0.0～192.168.255.255
```

#### 3.7 注意

`IP`地址127．0．0．1~127．255．255．255用于回路测试，如：127.0.0.1可以代表本机IP地址，用`http://127.0.0.1`就可以测试本机中配置的Web服务器。

### 4.Linux命令(ping, ifconfig)

#### 4.1 查看或配置网卡信息：`ifconfig`

- `ifconfig` 查看
- `sudo ifconfig 网卡名(如ens33) ip`  修改网卡的ip
- `sudo dhclient` 重新被动分配ip
- `sudo ifconfig 网卡名 down`  关闭网卡
- `sudo ifconfig 网卡名 up`  开启网卡
- `sudo /etc/init.d/networking restart` 重启网卡

#### 4.2 修改网络配置(Ubuntu16.04)

配置文件是 `/etc/network/interfaces`

- `sudo vim /etc/network/interfaces`
  - 修改之前可以先做一个备份

```shell
# 动态获取
auto eth0
iface eth0 inet dhcp
```

```shell
# 静态地址
auto eth0
iface eth0 inet static
address 10.0.0.5
netmask 255.255.255.0
gateway 10.0.0.1
dns-nameservers 119.29.29.29 223.5.5.5
```

- 重启网卡: `sudo /etc/init.d/networking restart`

## 二、端口

### 1. 什么是端口

- 端口就好一个房子的门，是出入这间房子的必经之路。
- 收发网络数据需要端口, IP地址与网络服务的关系是一对多的关系, 需要通过“IP地址+端口号”来区分不同的网络通信服务

### 2.端口号

- 在linux系统中，端口可以有65536（2的16次方）个之多！
  - 注意：端口数不一样的*nix系统不一样，还可以手动修改
- 范围: `0~65535`

### 3.端口分类(其中一种方式)

#### 3.1 知名端口（Well Known Ports）

- 范围从0到1023

- 例如: 

  ```
  80端口分配给HTTP服务
  21端口分配给FTP服务
  22端口分配给ssh服务
  ```

- 一般情况下，如果一个程序需要使用知名端口的需要有root权限

#### 3.2 动态端口（Dynamic Ports）

- 动态端口的范围是从1024到65535
- 主机根据程序的申请 **动态分配**, 程序关闭则端口释放

### 4.查看端口命令(`netstat`, `lsof`)

- `netstat -an` 查看端口状态
- `lsof -i [tcp/udp]:3306`

